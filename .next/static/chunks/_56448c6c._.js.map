{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kaiky/OneDrive/%C3%81rea%20de%20Trabalho/Auraline/app-nutricional/src/components/ui/AInput.tsx"],"sourcesContent":["\"use client\";\r\n\r\nexport default function AInput({ label, ...props }: any) {\r\n  return (\r\n    <div className=\"flex flex-col gap-1 w-full\">\r\n      <label className=\"text-sm text-[#6F6F6F]\">{label}</label>\r\n      <input\r\n        {...props}\r\n        className=\"w-full px-4 py-3 rounded-xl bg-[#F5F5F5] outline-none border border-transparent focus:border-[#00C974] transition-all\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEe,SAAS,OAAO,KAAwB;QAAxB,EAAE,KAAK,EAAE,GAAG,OAAY,GAAxB;IAC7B,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAM,WAAU;0BAA0B;;;;;;0BAC3C,6LAAC;gBACE,GAAG,KAAK;gBACT,WAAU;;;;;;;;;;;;AAIlB;KAVwB","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kaiky/OneDrive/%C3%81rea%20de%20Trabalho/Auraline/app-nutricional/src/components/ui/AButton.tsx"],"sourcesContent":["\"use client\";\r\n\r\nexport default function AButton({ children, type = \"button\", onClick }: any) {\r\n  return (\r\n    <button\r\n      type={type}\r\n      onClick={onClick}\r\n      className=\"w-full bg-[#00C974] text-white py-3 rounded-xl font-semibold text-lg active:scale-[0.98] transition-all\"\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEe,SAAS,QAAQ,KAA2C;QAA3C,EAAE,QAAQ,EAAE,OAAO,QAAQ,EAAE,OAAO,EAAO,GAA3C;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,SAAS;QACT,WAAU;kBAET;;;;;;AAGP;KAVwB","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kaiky/OneDrive/%C3%81rea%20de%20Trabalho/Auraline/app-nutricional/src/app/signup/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport AInput from \"@/components/ui/AInput\";\r\nimport AButton from \"@/components/ui/AButton\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\nexport default function Signup() {\r\n  const { signUp } = useAuth();\r\n  const router = useRouter();\r\n\r\n  const [nome, setNome] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [senha, setSenha] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSignup = async () => {\r\n   try {\r\n    setLoading(true);\r\n\r\n    // 1) criar usuário no Auth e capturar id diretamente do retorno\r\n    const { data, error } = await supabase.auth.signUp({\r\n      email,\r\n      password: senha,\r\n      // opcional: emailRedirectTo evita alguns problemas de confirmação\r\n      options: { emailRedirectTo: `${location.origin}/home` },\r\n    });\r\n\r\n    if (error) throw error;\r\n\r\n    // Pega o id retornado (use o retorno direto, NÃO dependa do AuthContext aqui)\r\n    const userId = data.user?.id;\r\n    if (!userId) {\r\n      // caso extremo: tentar buscar sessão ativa\r\n      const sessionRes = await supabase.auth.getSession();\r\n      const uid = sessionRes.data?.session?.user?.id;\r\n      if (!uid) throw new Error(\"Não foi possível obter ID do usuário após signUp.\");\r\n      // se veio aqui, use uid\r\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n      // userId = uid; // Typescript const -> não alteramos, só para referência\r\n    }\r\n\r\n    // 2) inserir usuário na tabela 'users' (inclui o plano vindo da query)\r\n    const planoQuery = typeof window !== \"undefined\"\r\n      ? new URLSearchParams(window.location.search).get(\"plano\")\r\n      : null;\r\n\r\n    const { error: insertUserError } = await supabase.from(\"users\").insert({\r\n      id: userId,\r\n      email,\r\n      name: nome,\r\n      plano: planoQuery ?? \"gratis\",\r\n      created_at: new Date().toISOString(),\r\n    });\r\n\r\n    if (insertUserError) throw insertUserError;\r\n\r\n    // 3) ler quiz salvo localmente\r\n    const quizDataString = localStorage.getItem(\"quizData\");\r\n    if (!quizDataString) {\r\n      // Não quebrar aqui; salvamos o usuário já criado — só logamos aviso\r\n      console.warn(\"Quiz não encontrado no localStorage — usuário criado sem quiz.\");\r\n      router.push(\"/home\");\r\n      return;\r\n    }\r\n    const quizData = JSON.parse(quizDataString);\r\n\r\n    // 4) salvar quiz_responses com user_id (usar quizService ou supabase direto)\r\n    // Usando quizService (recomendo porque já tem validações)\r\n    const payload = {\r\n      ...quizData,\r\n      peso_atual: Number(quizData.peso_atual),\r\n      altura: Number(quizData.altura),\r\n      peso_desejado: Number(quizData.peso_desejado),\r\n    };\r\n\r\n    const saveRes = await quizService.saveQuizResponses(userId, payload);\r\n    if (!saveRes.success) {\r\n      // tentar inserir manualmente como fallback\r\n      const fallback = await supabase.from(\"quiz_responses\").insert({\r\n        user_id: userId,\r\n        objetivo: payload.objetivo,\r\n        nivel_treino: payload.nivel_treino,\r\n        frequencia_treino: payload.frequencia_treino,\r\n        horario_treino: payload.horario_treino,\r\n        alimentacao_atual: payload.alimentacao_atual,\r\n        refeicoes_dia: payload.refeicoes_dia,\r\n        rotina_trabalho: payload.rotina_trabalho,\r\n        nivel_disciplina: payload.nivel_disciplina,\r\n        dificuldade_principal: payload.dificuldade_principal,\r\n        horario_dificil: payload.horario_dificil,\r\n        agua: payload.agua,\r\n        sono: payload.sono,\r\n        tentou_dieta: payload.tentou_dieta,\r\n        expectativa: payload.expectativa,\r\n        prazo_resultado: payload.prazo_resultado,\r\n        peso_atual: payload.peso_atual,\r\n        altura: payload.altura,\r\n        peso_desejado: payload.peso_desejado,\r\n        alergias: payload.alergias,\r\n        outras_alergias: payload.outras_alergias ?? null,\r\n        created_at: new Date().toISOString(),\r\n      });\r\n\r\n      if (fallback.error) {\r\n        console.error(\"Erro ao salvar quiz (fallback):\", fallback.error);\r\n        // Continuar o fluxo (não travar o usuário no cadastro)\r\n      }\r\n    }\r\n\r\n    // 5) atualizar campos básicos do usuário na tabela users\r\n    const { error: updateErr } = await supabase\r\n      .from(\"users\")\r\n      .update({\r\n        peso_atual: payload.peso_atual,\r\n        peso_inicial: payload.peso_atual,\r\n        peso_desejado: payload.peso_desejado,\r\n        altura: payload.altura,\r\n        objetivo: payload.objetivo,\r\n        nivel_treino: payload.nivel_treino,\r\n        frequencia_semanal: payload.frequencia_treino,\r\n      })\r\n      .eq(\"id\", userId);\r\n\r\n    if (updateErr) {\r\n      console.warn(\"Erro ao atualizar user com campos do quiz:\", updateErr);\r\n    }\r\n\r\n    // 6) limpar localStorage e redirecionar para home\r\n    localStorage.removeItem(\"quizData\");\r\n    localStorage.removeItem(\"quiz_completed\");\r\n    localStorage.removeItem(\"planoSelecionado\");\r\n\r\n    // opcional: aguardar 500ms para garantir commit no DB\r\n    await new Promise((r) => setTimeout(r, 300));\r\n\r\n    router.push(\"/home\");\r\n  } catch (err: any) {\r\n    console.error(err);\r\n    alert(err.message || \"Erro ao criar conta. Tente novamente.\");\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\n  return (\r\n    <div className=\"min-h-screen w-full flex items-center justify-center p-6\">\r\n      <div className=\"w-full max-w-sm flex flex-col gap-6\">\r\n        <h1 className=\"text-3xl font-bold text-[#0A0A0A]\">\r\n          Criar conta\r\n        </h1>\r\n\r\n        <div className=\"flex flex-col gap-4\">\r\n          <AInput\r\n            label=\"Nome\"\r\n            value={nome}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              setNome(e.target.value)\r\n            }\r\n          />\r\n\r\n          <AInput\r\n            label=\"Email\"\r\n            type=\"email\"\r\n            value={email}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              setEmail(e.target.value)\r\n            }\r\n          />\r\n\r\n          <AInput\r\n            label=\"Senha\"\r\n            type=\"password\"\r\n            value={senha}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              setSenha(e.target.value)\r\n            }\r\n          />\r\n\r\n          <AButton type=\"button\" onClick={handleSignup}>\r\n            {loading ? \"Criando conta...\" : \"Criar conta\"}\r\n          </AButton>\r\n\r\n          <p className=\"text-center text-sm mt-2 text-[#6F6F6F]\">\r\n            Já tem conta?{\" \"}\r\n            <span\r\n              onClick={() => router.push(\"/login\")}\r\n              className=\"text-[#00C974] font-semibold cursor-pointer\"\r\n            >\r\n              Entrar\r\n            </span>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kaiky/OneDrive/%C3%81rea%20de%20Trabalho/Auraline/app-nutricional/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}