{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kaiky/OneDrive/%C3%81rea%20de%20Trabalho/Auraline/app-nutricional/src/app/api/users/create/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst SERVICE_ROLE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY!;\r\n\r\n// client admin\r\nconst supabaseAdmin = createClient(SUPABASE_URL, SERVICE_ROLE_KEY, {\r\n  auth: { persistSession: false },\r\n});\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const { userId, name, email, plan } = body;\r\n\r\n    if (!userId || !email) {\r\n      return NextResponse.json(\r\n        { error: \"Missing required fields\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // inserir no users (sem depender de auth)\r\n    const { error: insertErr } = await supabaseAdmin\r\n      .from(\"users\")\r\n      .insert({\r\n        id: userId,\r\n        name,\r\n        email,\r\n        plan,\r\n        onboarding_done: true,\r\n        created_at: new Date().toISOString(),\r\n      });\r\n\r\n    if (insertErr) {\r\n      console.error(\"Admin insert error:\", insertErr);\r\n      return NextResponse.json(\r\n        { error: \"Failed to insert user\", details: insertErr },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json({ success: true });\r\n  } catch (err: any) {\r\n    console.error(\"users/create error:\", err);\r\n    return NextResponse.json(\r\n      { error: err.message || \"Unexpected error\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEA,MAAM;AACN,MAAM,mBAAmB,QAAQ,GAAG,CAAC,yBAAyB;AAE9D,eAAe;AACf,MAAM,gBAAgB,CAAA,GAAA,yLAAA,CAAA,eAAY,AAAD,EAAE,cAAc,kBAAkB;IACjE,MAAM;QAAE,gBAAgB;IAAM;AAChC;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG;QAEtC,IAAI,CAAC,UAAU,CAAC,OAAO;YACrB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,0CAA0C;QAC1C,MAAM,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,cAChC,IAAI,CAAC,SACL,MAAM,CAAC;YACN,IAAI;YACJ;YACA;YACA;YACA,iBAAiB;YACjB,YAAY,IAAI,OAAO,WAAW;QACpC;QAEF,IAAI,WAAW;YACb,QAAQ,KAAK,CAAC,uBAAuB;YACrC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAAyB,SAAS;YAAU,GACrD;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO,IAAI,OAAO,IAAI;QAAmB,GAC3C;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}